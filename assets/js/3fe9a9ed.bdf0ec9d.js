"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[855],{7346:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>K,contentTitle:()=>N,default:()=>B,frontMatter:()=>M,metadata:()=>s,toc:()=>O});const s=JSON.parse('{"id":"website/camera","title":"Animate Camera","description":"","source":"@site/src/examples/website/camera.mdx","sourceDirName":"website","slug":"/website/camera","permalink":"/examples/website/camera","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"defaultSidebar","previous":{"title":"React Quick Start","permalink":"/examples/website/quick-start"},"next":{"title":"Landmark Tour","permalink":"/examples/website/terrain"}}');var a=i(4848),n=i(8453),r=i(6540),o=(i(5338),i(4997)),l=i(7809),h=i(9861),c=i(2642),d=i(4471),p=i(3207),m=i(5133),u=i(9460),f=i(6510),g=i(8469),y=i(9510),b=i(5846),w=i(2312);const v="https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/bart-stations.json";const x=new b.A({getLayers:function(e){const t=e.layerKeyframes["scatterplot-layer"].getFrame(),i=e.layerKeyframes["text-layer"].getFrame();return[new u.A({id:"polygon-layer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/sf-zipcodes.json",stroked:!0,filled:!0,lineWidthMinPixels:2,getPolygon:e=>e.contour,getFillColor:e=>[22,133,248],getLineColor:[61,20,76,255],getLineWidth:3,opacity:1,material:{ambient:1,diffuse:0,shininess:175,specularColor:[255,255,255]}}),new f.A({id:"scatterplot-layer",data:v,opacity:.9,stroked:!1,filled:!0,radiusScale:t.radiusScale,radiusMinPixels:1,radiusMaxPixels:100,lineWidthMinPixels:1,getPosition:e=>[...e.coordinates,5],getRadius:e=>260-Math.sqrt(e.exits),getFillColor:e=>[233,0,255],getLineColor:e=>[245,39,137]}),new g.A({id:"path-layer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/bart-lines.json",widthScale:20,widthMinPixels:2,getPath:e=>e.path.map((e=>[...e,20])),getColor:e=>[250,235,44,255],getWidth:e=>2}),new y.A({id:"text-layer",data:v,fontFamily:"monospace",fontSettings:{fontSize:100,sdf:!0},opacity:i.opacity,getPosition:e=>[...e.coordinates,200],getText:e=>e.name,getSize:22,getAngle:0,getTextAnchor:"start",getAlignmentBaseline:"center",getPixelOffset:[i.pixelOffsetX,0],getColor:[250,235,44,255],updateTriggers:{getPixelOffset:i.pixelOffsetX}})]},layerKeyframes:[{id:"scatterplot-layer",features:["radiusScale"],keyframes:[{radiusScale:0},{radiusScale:6}],timings:[0,2e3],easings:[w.bt]},{id:"text-layer",features:["opacity","pixelOffsetX"],keyframes:[{opacity:0,pixelOffsetX:200},{opacity:1,pixelOffsetX:32}],timings:[500,2e3],easings:[w.vT]}]}),k={longitude:-122.435,latitude:37.753,zoom:10,pitch:-37,bearing:0,minPitch:-90,maxPitch:90},j={width:640,height:480},C={webm:{quality:.8},png:{archive:"zip"},jpeg:{quality:.8,archive:"zip"},gif:{sampleInterval:1e3,width:j.width,height:j.height}},A={start:0,end:5e3,framerate:30},S=new p.A(c.d,{}),_=new p.A(d.R,{});function F(e){const t=["width","height","altitude","position","normalize"];return Object.keys(e).filter((e=>!t.includes(e))).reduce(((t,i)=>(t[i]=e[i],t)),{})}const T=e=>{let{children:t}=e;return(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",position:"relative",backgroundColor:"#11183c",overflow:"hidden"},children:t})};function E(){const e=(0,r.useRef)(null),[t,i]=(0,r.useState)(!1),{deckProps:s,adapter:n,cameraFrame:c,setCameraFrame:d}=(0,l.pp)({deckRef:e,deckAnimation:x,initialViewState:k}),[p,u]=(0,r.useState)(c),[f,g]=(0,r.useState)(Object.assign({},c,{zoom:c.zoom+1,pitch:c.pitch+37}));return(0,r.useEffect)((()=>{n.animationManager.setKeyframes("deck",{cameraKeyframe:{width:j.width,height:j.height,timings:[0,A.end-250],keyframes:[p,f],easings:w.am}})}),[p,f]),(0,a.jsxs)(T,{children:[(0,a.jsx)("div",{style:{position:"relative"},children:(0,a.jsx)(o.A,Object.assign({ref:t=>e.current=null==t?void 0:t.deck,style:{position:"unset"},views:new m.A({farZMultiplier:3}),parameters:{depthTest:!1,clearColor:[61/255,20/255,76/255,1]},viewState:c,onViewStateChange:e=>{let{viewState:t}=e;d(t)},controller:!0,effects:[_,S],width:j.width,height:j.height},s))}),(0,a.jsxs)(h.A,{adapter:n,busy:t,setBusy:i,formatConfigs:C,timecode:A,filename:"camera",children:[(0,a.jsx)("button",{disabled:t,onClick:()=>u(F(c)),children:"Set Camera Start"}),(0,a.jsx)("button",{disabled:t,onClick:()=>g(F(c)),children:"Set Camera End"})]})]})}const M={},N="Animate Camera",K={},O=[];function P(e){const t={h1:"h1",header:"header",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"animate-camera",children:"Animate Camera"})}),"\n","\n",(0,a.jsx)(E,{})]})}function B(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(P,{...e})}):P(e)}},5846:(e,t,i)=>{i.d(t,{A:()=>b});var s=i(7036),a=i(1111),n=i(2312),r=i(1365);class o extends s.E{constructor(e){let{features:t=[],timings:i,keyframes:s,easings:n=a.s,interpolators:r="linear"}=e;super([]),this.activeFeatures={},this._setActiveFeatures=this._setActiveFeatures.bind(this),this.getFrame=this.getFrame.bind(this),this.set=this.set.bind(this),this.activeFeatures=t.reduce(((e,t)=>(e[t]=!1,e)),{}),this.set({timings:i,keyframes:s,easings:n,interpolators:r})}set(e){let{timings:t,keyframes:i,easings:s=a.s,interpolators:n="linear"}=e;if(!i||0===i.length)throw new Error("There must be at least one keyframe");const r=function(e,t){if("string"==typeof t){const i=[];for(let s=0;s<e.length-1;s++)i.push(t);return i}if(e.length-1!==t.length)throw new Error("There must be one fewer interpolator than keyframes");return t}(i,n),o=function(e,t){if("function"==typeof t){const i=[];for(let s=0;s<e.length-1;s++)i.push(t);return i}if(e.length-1!==t.length)throw new Error("There must be one fewer easing than keyframes");return t}(i,s),l=function(e,t){if("number"==typeof t){const i=[];let s=0;for(let a=0;a<e.length;a++)i.push(s),s+=t;return i}if(e.length!==t.length)throw new Error("There must be same number of timings as keyframes");return t}(i,t);this._setActiveFeatures(i);const h=function(e,t,i,s){return t.map(((t,a)=>0===a?[e[a],Object.assign({},t,{ease:void 0,interpolate:void 0})]:[e[a],Object.assign({},t,{ease:i[a-1],interpolate:s[a-1]})]))}(l,i,o,r);this.keyframes=i,this.timings=t,this.easings=s,this.interpolators=n,this.setKeyFrames(h)}getFrame(){const e=this.factor,t=this.getStartData(),i=this.getEndData(),s={};return Object.keys(this.activeFeatures).forEach((a=>{this.activeFeatures[a]&&(s[a]=function(e,t,i){return void 0===i&&(i=n.sn),(0,r.G)([0,1],[e,t],{ease:i})}(t[a],i[a],i.ease)(e))})),s}_setActiveFeatures(e){const t=e[0];this.activeFeatures=Object.keys(t).reduce(((e,i)=>(void 0!==t[i]&&(e[i]=!0),e)),this.activeFeatures)}}const l=o;var h=i(3276),c=i(4692);const d=["bearing","pitch"],p={speed:1.2,curve:1.414};class m extends l{constructor(e){let{timings:t,keyframes:i,easings:s,interpolators:a,width:n,height:r}=e;super({timings:t,keyframes:i,easings:s,interpolators:a,features:["latitude","longitude","zoom","pitch","bearing"]}),this.width=n,this.height=r}getFrame(){const e=this.factor,t=this.getStartData(),i=this.getEndData();if("flyTo"===i.interpolate){if(!this.width||!this.height)throw new Error("width and height must be defined to use flyTo interpolator");const s=this.getEndTime()-this.getStartTime();return function(e,t,i,s){const a=(0,h.rj)(e,t,t.ease(i),Object.assign({},p,s));for(const n of d)a[n]=(0,c.Cc)(e[n]||0,t[n]||0,t.ease(i));return a}(Object.assign({},t,{width:this.width,height:this.height}),i,e,{maxDuration:s})}return super.getFrame()}}function u(e){return e&&e[0]?Object.keys(e[0]):[]}class f extends l{constructor(e){let{id:t,features:i,timings:s,keyframes:a,easings:n}=e;super({timings:s,keyframes:a,easings:n,features:i||u(a)}),this.id=t}}class g{constructor(e){let{id:t}=e;this.unattachedKeyframes=[],this.id=t,this.unattachedKeyframes=[]}attachKeyframes(e){for(const t of this.unattachedKeyframes)t.animationHandle&&e.detachAnimation(t.animationHandle),t.animationHandle=e.attachAnimation(t,void 0);this.unattachedKeyframes=[]}getKeyframes(){throw new Error("not implemented")}setKeyframes(e){throw new Error("not implemented")}animator(e){throw new Error("not implemented")}draw(){return this.animator(this)}}function y(){}class b extends g{constructor(e){let{id:t="deck",cameraKeyframe:i,getLayers:s=e=>[],layerKeyframes:a=[],onLayersUpdate:n=y,onCameraUpdate:r=y}=e;super({id:t}),this.layerKeyframes={},this.layerKeyframes={},this.onLayersUpdate=n,this.onCameraUpdate=r,this.getLayers=s,this.setKeyframes({cameraKeyframe:i,layerKeyframes:a}),this.draw()}setOnLayersUpdate(e){this.onLayersUpdate=e}setOnCameraUpdate(e){this.onCameraUpdate=e}setGetLayers(e){this.getLayers=e,this.draw()}setKeyframes(e){let{layerKeyframes:t=[],cameraKeyframe:i,timeline:s}=e;this.cameraKeyframe&&i?this.cameraKeyframe.set(i):i&&(this.cameraKeyframe=new m(i),this.unattachedKeyframes.push(this.cameraKeyframe)),t&&t.length>0&&(this.layerKeyframes=t.reduce(((e,t)=>(e[t.id]?e[t.id].set(t):(e[t.id]=new f(t),this.unattachedKeyframes.push(e[t.id])),e)),this.layerKeyframes)),s&&this.attachKeyframes(s)}getKeyframes(){return{cameraKeyframe:this.cameraKeyframe,layerKeyframes:this.layerKeyframes}}animator(e){e.cameraKeyframe&&e.onCameraUpdate(e.cameraKeyframe.getFrame()),Object.values(e.layerKeyframes).length>0&&e.onLayersUpdate(this.getLayers(e))}applyLayerKeyframes(e){return e.map((e=>{if(this.layerKeyframes[e.id]){const t=this.layerKeyframes[e.id].getFrame();return e.clone(Object.assign({},t,{updateTriggers:t}))}return e}))}}},1353:(e,t,i)=>{i.d(t,{A:()=>s});class s{constructor(e){void 0===e&&(e={}),this.extension="",this.mimeType="",this.framerate=e.framerate||30}start(){throw new Error("Encoder: Implement a start function")}async add(e){throw new Error("Encoder: Implement an add function")}async save(){throw new Error("Encoder: Implement a save function")}}},1750:(e,t,i)=>{i.d(t,{A:()=>a});var s=i(1353);class a extends s.A{start(){this.af&&cancelAnimationFrame(this.af)}async add(e){return new Promise((e=>{this.af&&cancelAnimationFrame(this.af),this.af=requestAnimationFrame((()=>e()))}))}async save(){return this.af&&cancelAnimationFrame(this.af),await Promise.resolve(null)}}},1111:(e,t,i)=>{i.d(t,{_:()=>s,s:()=>a});const s=e=>1===e?1:0,a=e=>e},9861:(e,t,i)=>{i.d(t,{A:()=>me});var s=i(6540),a=i(6065),n=i(4848);const r=a.Ay.div.withConfig({displayName:"input__InputContainer",componentId:"sc-4i6k7t-0"})(["position:relative;width:100%;font:14px / 20px Helvetica,Arial,sans-serif;box-sizing:border-box;&:last-child{margin-bottom:20px;}> *{vertical-align:middle;white-space:nowrap;}label{display:inline-block;width:40%;margin-right:10%;margin-top:2px;margin-bottom:2px;}input,a,button,select{background:#fff;font-size:0.9em;text-transform:none;text-overflow:ellipsis;overflow:hidden;display:inline-block;padding:0 4px;margin:0;width:50%;height:20px;line-height:1.833;text-align:left;}button{color:initial;}button:disabled{color:#aaa;cursor:default;background:#eee;}input{border:solid 1px #ccc;&:disabled{background:#eee;}&[type='checkbox']{height:auto;}}.tooltip{left:50%;top:24px;opacity:0;pointer-events:none;transition:opacity 200ms;}&:hover .tooltip{opacity:1;}"]);class o extends s.PureComponent{_onChange(e){const{value:t,type:i}=e.target;let s=t;"checkbox"===i&&(s=e.target.checked),"range"===i&&(s=Number(t),void 0!==this.props.min&&(s=Math.max(this.props.min,s)),void 0!==this.props.max&&(s=Math.min(this.props.max,s))),this.props.onChange(this.props.name,s)}_resetFunction(){return this.props.onChange(this.props.name,this.props.altValue)}render(){const{displayName:e,type:t,displayValue:i,disabled:s}=this.props,a=Object.assign({},this.props);if(delete a.displayName,delete a.displayValue,delete a.altType,delete a.altValue,"link"===t)return(0,n.jsxs)("div",{className:"input",children:[(0,n.jsx)("label",{children:e}),(0,n.jsx)("a",{href:i,target:"_new",children:i})]});if("function"===t||"json"===t){const t="altValue"in this.props;return(0,n.jsxs)("div",{className:"input",children:[(0,n.jsx)("label",{children:e}),(0,n.jsx)("button",{type:"button",disabled:!t||s,onClick:this._resetFunction.bind(this),children:i})]})}return"select"===t?(0,n.jsx)(r,{children:(0,n.jsxs)("div",{className:"input",children:[(0,n.jsx)("label",{children:e}),(0,n.jsx)("select",{disabled:s,onChange:this._onChange.bind(this),value:i,children:a.options.map(((e,t)=>(0,n.jsx)("option",{value:e,children:e},t)))})]})}):("checkbox"===t&&(a.checked=a.value),(0,n.jsxs)(r,{children:[(0,n.jsx)("label",{children:e}),(0,n.jsxs)("div",{className:"tooltip",children:[e,": ",String(i)]}),(0,n.jsx)("input",Object.assign({},a,{value:i,onChange:this._onChange.bind(this)}))]}))}}var l=i(1750),h=i(7273),c=i(1353);class d extends c.A{constructor(e){super(e),this.gifBuilder=null,this.source="images",this.mimeType="image/gif",this.extension=".gif";let t={width:720,height:480,numWorkers:4,sampleInterval:10,jpegQuality:1};e.gif&&(t=Object.assign({},t,e.gif)),this.options=t,this.start=this.start.bind(this),this.add=this.add.bind(this),this.save=this.save.bind(this)}start(){this.gifBuilder=new h.A(Object.assign({source:this.source},this.options,{interval:1/this.framerate}))}async add(e){if("images"===this.source){const t=e.toDataURL("image/jpeg",this.options.jpegQuality);await this.gifBuilder.add(t)}}async save(){return fetch(await this.gifBuilder.build()).then((e=>e.blob()))}}var p=i(8964),m=i.n(p);class u extends c.A{constructor(e){super(e),this.quality=.8,e.webm&&e.webm.quality&&(this.quality=e.webm.quality);"image/webp"!==document.createElement("canvas").toDataURL("image/webp").substr(5,10)&&console.error("WebP not supported - try another export format"),this.extension=".webm",this.mimeType="video/webm",this.videoWriter=null,this.start=this.start.bind(this),this.add=this.add.bind(this),this.save=this.save.bind(this)}start(){this.videoWriter=new(m())({quality:this.quality,fileWriter:null,fd:null,frameRate:this.framerate})}async add(e){this.videoWriter.addFrame(e),await Promise.resolve()}async save(){return this.videoWriter.complete()}}const f=u;function g(e){let t;const i=new Uint8Array(e);for(t=0;t<e;t+=1)i[t]=0;return i}function y(e,t,i){void 0===i&&(i=8);const s=e.toString(i);return"000000000000".substr(s.length+12-t)+e}const b=[{field:"fileName",length:100},{field:"fileMode",length:8},{field:"uid",length:8},{field:"gid",length:8},{field:"fileSize",length:12},{field:"mtime",length:12},{field:"checksum",length:8},{field:"type",length:1},{field:"linkName",length:100},{field:"ustar",length:8},{field:"owner",length:32},{field:"group",length:32},{field:"majorNumber",length:8},{field:"minorNumber",length:8},{field:"filenamePrefix",length:155},{field:"padding",length:12}];let w;const v=512;const x=class{constructor(e){this.written=0,w=(e||20)*v,this.out=g(w),this.blocks=[],this.length=0,this.save=this.save.bind(this),this.clear=this.clear.bind(this),this.append=this.append.bind(this)}append(e,t,i){var s;let a;if(void 0===i&&(i={}),"string"==typeof t)t=function(e,t,i){let s,a;for(void 0===i&&(i=0),t=t||g(e.length),s=0,a=e.length;s<a;s+=1)t[i]=e.charCodeAt(s),i+=1;return t}(t);else if(null!=(s=t)&&s.constructor&&t.constructor!==Uint8Array.prototype.constructor){var n;throw"Invalid input type. You gave me: "+(null==(n=t.constructor.toString().match(/function\s*([$A-Za-z_][0-9A-Za-z_]*)\s*\(/))?void 0:n.at(1))}const r=i.mode||4095&parseInt("777",8),o=i.mtime||Math.floor(Number(new Date)/1e3),l=i.uid||0,h=i.gid||0,c={fileName:e,fileMode:y(r,7),uid:y(l,7),gid:y(h,7),fileSize:y(t.length,11),mtime:y(o,11),checksum:"        ",type:"0",ustar:"ustar  ",owner:i.owner||"",group:i.group||""};a=0,Object.keys(c).forEach((e=>{let t;const i=c[e];let s;for(t=0,s=i.length;t<s;t+=1)a+=i.charCodeAt(t)})),c.checksum=y(a,6)+"\0 ";const d=function(e,t){const i=g(512);let s=0;return b.forEach((t=>{const a=e[t.field]||"";let n,r;for(n=0,r=a.length;n<r;n+=1)i[s]=a.charCodeAt(n),s+=1;s+=t.length-n})),"function"==typeof t?t(i,s):i}(c),p=Math.ceil(d.length/v)*v,m=Math.ceil(t.length/v)*v;this.blocks.push({header:d,input:t,headerLength:p,inputLength:m})}save(){const e=[],t=[];let i=0;const s=Math.pow(2,20);let a=[];return this.blocks.forEach((e=>{i+e.headerLength+e.inputLength>s&&(t.push({blocks:a,length:i}),a=[],i=0),a.push(e),i+=e.headerLength+e.inputLength})),t.push({blocks:a,length:i}),t.forEach((t=>{const i=new Uint8Array(t.length);let s=0;t.blocks.forEach((e=>{i.set(e.header,s),s+=e.headerLength,i.set(e.input,s),s+=e.inputLength})),e.push(i)})),e.push(new Uint8Array(1024)),new Blob(e,{type:"octet/stream"})}clear(){this.written=0,this.out=g(w)}},k={recordsPerBlock:20};class j{static get properties(){return{id:"tar",name:"TAR",extensions:["tar"],mimeType:"application/x-tar",builder:j,options:k}}constructor(e){this.options=Object.assign({},k,e),this.tape=new x(this.options.recordsPerBlock),this.count=0}addFile(e,t){this.tape.append(t,new Uint8Array(e)),this.count++}async build(){return new Response(this.tape.save()).arrayBuffer()}}function C(e){return String("0000000"+e).slice(-7)}async function A(e,t,i){const s=e.toDataURL(t,i),a=await fetch(s);return await a.arrayBuffer()}var S=i(9147),_=i(3790);const F="tar",T="zip";class E extends c.A{constructor(e){switch(super(e),this.tarBuilder=null,this.filemap={},this.options={quality:1,archive:F},e.jpeg&&(this.options=Object.assign({},e.jpeg)),this.options.quality=this.options.quality||1,this.options.archive=this.options.archive||F,this.options.archive){case F:this.mimeType=j.properties.mimeType,this.extension="."+j.properties.extensions[0];break;case T:var t,i;this.mimeType=(null==(t=_.V.mimeTypes)?void 0:t[0])||"",this.extension="."+(null==(i=_.V.extensions)?void 0:i[0]);break;default:throw new Error("Unsupported archive type [zip, tar]: "+this.options.archive)}}start(){this.tarBuilder=new j({}),this.filemap={}}async add(e){const t=".jpg",i=await A(e,"image/jpeg",this.options.quality);switch(this.options.archive){case F:{if(!this.tarBuilder)break;const e=C(this.tarBuilder.count)+t;this.tarBuilder.addFile(i,e);break}case T:{const e=C(Object.keys(this.filemap).length)+t;this.filemap[e]=i;break}default:throw new Error("Unsupported archive type [zip, tar]: "+this.options.archive)}}async save(){switch(this.options.archive){case F:{if(!this.tarBuilder)break;const e=await this.tarBuilder.build();return new Blob([e],{type:j.properties.mimeType})}case T:{var e;const t=await(0,S.lF)(this.filemap,_.V);return new Blob([t],{type:null==(e=_.V.mimeTypes)?void 0:e[0]})}default:throw new Error("Unsupported archive type [zip, tar]: "+this.options.archive)}return null}}const M=E,N="tar",K="zip";class O extends c.A{constructor(e){switch(super(e),this.tarBuilder=null,this.filemap={},this.options={archive:N},e.png&&(this.options=Object.assign({},e.png)),this.options.archive=this.options.archive||N,this.options.archive){case N:this.mimeType=j.properties.mimeType,this.extension="."+j.properties.extensions[0];break;case K:var t,i;this.mimeType=(null==(t=_.V.mimeTypes)?void 0:t[0])||"",this.extension="."+(null==(i=_.V.extensions)?void 0:i[0]);break;default:throw new Error("Unsupported archive type [zip, tar]: "+this.options.archive)}}start(){this.tarBuilder=new j({}),this.filemap={}}async add(e){const t=".png",i=await A(e,"image/png");switch(this.options.archive){case N:{if(!this.tarBuilder)break;const e=C(this.tarBuilder.count)+t;this.tarBuilder.addFile(i,e);break}case K:{const e=C(Object.keys(this.filemap).length)+t;this.filemap[e]=i;break}default:throw new Error("Unsupported archive type [zip, tar]: "+this.options.archive)}}async save(){switch(this.options.archive){case N:{if(!this.tarBuilder)break;const e=await this.tarBuilder.build();return new Blob([e],{type:j.properties.mimeType})}case K:{var e;const t=await(0,S.lF)(this.filemap,_.V);return new Blob([t],{type:null==(e=_.V.mimeTypes)?void 0:e[0]})}default:throw new Error("Unsupported archive type [zip, tar]: "+this.options.archive)}return null}}const P=O,B="Preview",R="WebM",L="JPEG Frames",z="PNG Frames",U="GIF",I=[B,R,L,z,U],V={[B]:l.A,[U]:d,[R]:f,[L]:M,[z]:P};function q(e){let{disabled:t,encoder:i,setEncoder:s}=e;return(0,n.jsx)(o,{type:"select",disabled:t,displayName:"Encoder",displayValue:i,onChange:(e,t)=>s(t),options:I})}var D=i(5556),W=i.n(D),H=i(8587);const G=["height","width","viewBox","style","children","predefinedClassName","className","colors","totalColor"];class X extends s.Component{render(){const e=this.props,{height:t,width:i,viewBox:s,style:a,children:r,predefinedClassName:o,className:l,colors:h,totalColor:c}=e,d=(0,H.A)(e,G),p=t,m=i||p,u=Array.isArray(h)&&c&&((e,t)=>new Array(e).fill(1).reduce(((e,i,s)=>e+".cr"+(s+1)+" {fill:"+t[s%t.length]+";}"),""))(c,h);return(0,n.jsxs)("svg",Object.assign({viewBox:s,width:m,height:p,style:a,className:o+" "+l},d,{children:[u?(0,n.jsx)("style",{type:"text/css",children:u}):null,r]}))}}X.displayName="Base Icon",X.propTypes={height:W().string,width:W().string,viewBox:W().string,children:W().node,predefinedClassName:W().string,className:W().string},X.defaultProps={height:null,width:null,viewBox:"0 0 64 64",predefinedClassName:"",className:"",style:{fill:"currentColor"}};class $ extends s.Component{render(){return(0,n.jsx)(X,Object.assign({},this.props,{children:(0,n.jsx)("path",{d:"M16 4c.552 0 1 .448 1 1v4.2l5.213-3.65c.226-.158.538-.103.697.124.058.084.09.184.09.286v12.08c0 .276-.224.5-.5.5-.103 0-.203-.032-.287-.09L17 14.8V19c0 .552-.448 1-1 1H2c-.552 0-1-.448-1-1V5c0-.552.448-1 1-1h14zm-6 4H8v4H5l4 4 4-4h-3V8z"})}))}}$.propTypes={height:W().string},$.defaultProps={height:"16px",predefinedClassName:"data-ex-icons-download-video",viewBox:"0 0 24 24"};var Q=i(801),Z=i(8950);const J=async(e,t)=>{const i=await(0,Q.q)(e,Z.p),s={};for(const a in i)s[a]=URL.createObjectURL(new Blob([i[a]],{type:t===L?"image/jpeg":"image/png"}));return s},Y=a.Ay.video.withConfig({displayName:"render-player__VideoPlayer",componentId:"sc-1oi3ufw-0"})(["margin:8px 0;width:100%;"]),ee=a.Ay.img.withConfig({displayName:"render-player__GifPlayer",componentId:"sc-1oi3ufw-1"})(["margin:8px 0;width:100%;"]),te=a.Ay.div.withConfig({displayName:"render-player__ScrollBox",componentId:"sc-1oi3ufw-2"})(["width:500px;height:400px;position:relative;overflow:auto;margin:8px 0;"]),ie=a.Ay.div.withConfig({displayName:"render-player__ImageGallery",componentId:"sc-1oi3ufw-3"})(["display:flex;flex-wrap:wrap;gap:8px;"]),se=a.Ay.img.withConfig({displayName:"render-player__Thumbnail",componentId:"sc-1oi3ufw-4"})(["width:64px;"]);function ae(e){let{encoder:t,blob:i}=e;const[a,r]=(0,s.useState)(""),[o,l]=(0,s.useState)({});switch((0,s.useEffect)((()=>{r("")}),[t]),(0,s.useEffect)((()=>{if(i)switch(t){case U:case R:r(URL.createObjectURL(i));break;case z:case L:"application/zip"===i.type&&J(i).then(l)}else r(""),l({})}),[i]),t){case R:return(0,n.jsx)(Y,{src:a,controls:!0,autoPlay:!0});case U:return(0,n.jsx)(ee,{src:a});case z:case L:return(0,n.jsx)(te,{children:(0,n.jsx)("div",{style:{position:"absolute"},children:(0,n.jsx)(ie,{children:Object.entries(o).map((e=>{let[t,i]=e;return(0,n.jsx)(se,{src:i,title:t},t)}))})})});default:return null}}const ne=a.Ay.div.withConfig({displayName:"basic-controls__RenderResult",componentId:"sc-1bx6uh6-0"})(["position:absolute;z-index:1;top:0;right:0;background-color:#fff;margin:24px;padding:10px 24px;box-shadow:rgba(0,0,0,0.16) 0px 1px 4px;min-width:300px;max-height:calc(100% - 48px);"]),re=a.Ay.div.withConfig({displayName:"basic-controls__RenderControls",componentId:"sc-1bx6uh6-1"})([""]),oe=a.Ay.div.withConfig({displayName:"basic-controls__ButtonGroup",componentId:"sc-1bx6uh6-2"})(["display:flex;flex-wrap:wrap;gap:8px;margin-top:8px;justify-content:flex-end;"]),le=a.Ay.div.withConfig({displayName:"basic-controls__Result",componentId:"sc-1bx6uh6-3"})(["display:",";max-width:500px;"],(e=>e.$show?"block":"none")),he=a.Ay.div.withConfig({displayName:"basic-controls__Status",componentId:"sc-1bx6uh6-4"})(["display:flex;align-items:center;"]),ce=a.Ay.h3.withConfig({displayName:"basic-controls__H3",componentId:"sc-1bx6uh6-5"})(["font-size:16px;margin:8px 0;font-family:Helvetica,Arial,sans-serif;"]),de=a.Ay.div.withConfig({displayName:"basic-controls__Download",componentId:"sc-1bx6uh6-6"})(["color:blue;cursor:pointer;padding:0 8px;display:",";"],(e=>e.$show?"flex":"none")),pe=a.Ay.div.withConfig({displayName:"basic-controls__TogglePlayer",componentId:"sc-1bx6uh6-7"})(["font-family:Helvetica,Arial,sans-serif;display:inline-block;user-select:none;margin:8px 0;text-decoration:underline;float:right;&:hover{color:blue;}"]);function me(e){let{children:t,adapter:i,busy:a,setBusy:r,formatConfigs:o,timecode:l,embed:h=!0,filename:c}=e;const[d,p]=(0,s.useState)(R),[m,u]=(0,s.useState)(void 0),[f,g]=(0,s.useState)(void 0),[y,b]=(0,s.useState)(!0),w=(0,s.useMemo)((()=>{switch(f){case"in-progress":return"Rendering animation...";case"saving":return"Processing render...";case"rendered":return"Render complete!";default:return"Renderer idle..."}}),[f]);(0,s.useEffect)((()=>{u(void 0),g(void 0)}),[d]);const v=(0,s.useCallback)((e=>{u(e),g("rendered")}),[]),x=(0,s.useCallback)((()=>{i.render({Encoder:V[d],formatConfigs:o,filename:c,timecode:l,onStopped:()=>g("saving"),onComplete:()=>r(!1),onSave:h&&v}),g("in-progress"),r(!0)}),[i,v,d,h,o,l,c]),k=(0,s.useCallback)((()=>{i.stop({onStopped:()=>g("saving"),onComplete:()=>r(!1),onSave:h&&v})}),[i,v,h]);return(0,n.jsx)(ne,{children:(0,n.jsxs)("div",{children:[(0,n.jsxs)(he,{children:[(0,n.jsx)(ce,{children:w}),(0,n.jsx)(de,{$show:Boolean(m),title:"Download",onClick:()=>{i.videoCapture.download(m)},children:(0,n.jsx)($,{height:"18px"})})]}),(0,n.jsxs)(re,{children:[(0,n.jsx)(q,{disabled:a,encoder:d,setEncoder:p}),(0,n.jsxs)(oe,{children:[(0,n.jsx)("button",{disabled:a,onClick:x,children:"Render"}),(0,n.jsx)("button",{disabled:!a||"saving"===f,onClick:k,children:"Interrupt"})]})]}),(0,n.jsxs)(le,{$show:Boolean(m),children:[(0,n.jsx)(pe,{onClick:()=>b(!y),children:y?"Hide Player":"Show Player"}),y&&(0,n.jsx)(ae,{encoder:d,blob:m})]}),(0,n.jsx)("div",{style:{marginTop:"8px"},children:t})]})})}},7809:(e,t,i)=>{i.d(t,{Gg:()=>m,Lp:()=>u,pp:()=>f,E6:()=>p});var s=i(6540),a=i(1750),n=i(6271);class r{constructor(e){let{timeline:t,animations:i=[]}=e;this.animations={},this.timeline=t||new n.K;for(const s of i)this.attachAnimation(s)}attachAnimation(e){e.attachKeyframes(this.timeline),this.animations[e.id]=e}setKeyframes(e,t){this.animations[e].setKeyframes(Object.assign({timeline:this.timeline},t))}getKeyframes(e){return this.animations[e].getKeyframes()}getAnimation(e){return this.animations[e]}draw(){Object.values(this.animations).forEach((e=>e.draw()))}}var o=i(56),l=i.n(o);class h{constructor(){this.recording=!1,this.capturing=!1,this.timeMs=0,this.onStop=null,this.recording=!1,this.capturing=!1,this.timeMs=0,this.timecode=null,this.encoder=null,this.filename=null,this._getNextTimeMs=this._getNextTimeMs.bind(this),this._step=this._step.bind(this),this._capture=this._capture.bind(this),this.capture=this.capture.bind(this),this.render=this.render.bind(this),this.download=this.download.bind(this),this.stop=this.stop.bind(this),this._save=this._save.bind(this)}isRecording(){return this.recording}render(e){let{Encoder:t,formatConfigs:i,timecode:s,filename:a,onStop:n}=e;this.isRecording()||(console.time("render"),this.filename=this._sanitizeFilename(a),this.timecode=this._sanatizeTimecode(s),console.log("Starting recording for "+this.timecode.duration+"ms."),this.onStop=n,this.encoder=new t(Object.assign({},i,{framerate:this.timecode.framerate})),this.recording=!0,this.encoder.start())}capture(e,t){!this.capturing&&this.isRecording()&&(this.capturing=!0,this._capture(e).then((e=>{if(this.capturing=!1,"next-frame"===e.kind)t(e.nextTimeMs);else if("stop"===e.kind){var i;null==(i=this.onStop)||i.call(this)}else console.log(e)})))}stop(e){let{onComplete:t,onSave:i,onStopped:s,abort:a=!1}=e;if(this.isRecording()){console.log("Stopped recording. Recorded for "+this.timeMs+"ms."),this.recording=!1,this.capturing=!1,s&&s(),console.timeEnd("render");const e=()=>{t&&t(),this.timecode=null,this.onStop=void 0};a||this._save(i).then(e),e()}}download(e){return e&&l()(e,this.filename+this.encoder.extension,this.encoder.mimeType),!1}async _save(e){e||(e=this.download),console.time("save"),await this.encoder.save().then(e).then((()=>console.timeEnd("save")))}_sanitizeFilename(e){return e||(e=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}()),e}_sanatizeTimecode(e){const t=Object.assign({duration:void 0},e);if(t.start||(t.start=0),this.timeMs=t.start,t.duration||(t.duration=t.end-t.start),t.duration<=0)throw new Error("Invalid recording length ("+t.duration+"ms).  Must be greater than 0.");return t}async _capture(e){return this.isRecording()?await this.encoder.add(e).then(this._step).catch((e=>({kind:"error",error:e}))):{kind:"error",error:"NOT_RECORDING"}}_step(){const e=this._getNextTimeMs();return e>this.timecode.end?{kind:"stop"}:(this.timeMs=e,{kind:"next-frame",nextTimeMs:e})}_getNextTimeMs(){const e=Math.floor(1e3/this.timecode.framerate);return this.timeMs+e}}class c{constructor(e){let{animationManager:t,glContext:i}=e;this.animationManager=t||new r({}),this.glContext=i,this.videoCapture=new h,this.shouldAnimate=!1,this.enabled=!1,this.getProps=this.getProps.bind(this),this.render=this.render.bind(this),this.stop=this.stop.bind(this),this.seek=this.seek.bind(this)}setDeck(e){this.deck=e}getProps(e){let{deck:t,onNextFrame:i,extraProps:s}=e;t&&(this.deck=t);const a={_animate:this.shouldAnimate};return i&&(a.onAfterRender=()=>this.onAfterRender(i)),this.enabled?a.controller=!1:a.controller=!0,this.glContext&&(a.gl=this.glContext),Object.assign({},s,a)}render(e){let{Encoder:t=a.A,formatConfigs:i={},filename:s,timecode:n={start:0,end:0,framerate:30},onStopped:r,onSave:o,onComplete:l}=e;this.shouldAnimate=!0,this.videoCapture.render({Encoder:t,formatConfigs:i,timecode:n,filename:s,onStop:()=>this.stop({onStopped:r,onSave:o,onComplete:l})}),this.enabled=!0,this.seek({timeMs:n.start})}stop(e){let{onStopped:t,onSave:i,onComplete:s,abort:a}=e;this.enabled=!1,this.shouldAnimate=!1,this.videoCapture.stop({onStopped:t,onSave:i,onComplete:s,abort:a})}seek(e){let{timeMs:t}=e;this.animationManager.timeline.setTime(t),this.animationManager.draw()}onAfterRender(e,t){void 0===t&&(t=!0);const i=this.deck&&this.deck.props.layers.every((e=>e.isLoaded));if(this.videoCapture.isRecording()&&i&&t){const t=this.deck.canvas;this.videoCapture.capture(t,(t=>{this.seek({timeMs:t}),e(t)}))}}}var d=i(5846);function p(){const[,e]=(0,s.useState)({});return(0,s.useCallback)((()=>e({})),[])}function m(e,t){void 0===t&&(t=void 0);const[i,a]=(0,s.useState)([]),[n,r]=(0,s.useState)(t);return{adapter:(0,s.useMemo)((()=>{const i=new c({});return e.setOnLayersUpdate(a),t&&e.setOnCameraUpdate(r),i.animationManager.attachAnimation(e),e.draw(),i}),[]),layers:i,cameraFrame:n,setCameraFrame:r}}function u(e){return(0,s.useMemo)((()=>new d.A(e)),[])}function f(e){let{deckRef:t,mapRef:i,deckAnimation:a,initialViewState:n}=e;const r=(0,s.useMemo)((()=>t.current),[t.current]),o=p(),{adapter:l,layers:h,cameraFrame:c,setCameraFrame:d}=m(a,n),u=(0,s.useCallback)((()=>{if(i){const e=i.current.getMap();e.on("render",(()=>l.onAfterRender(o,e.areTilesLoaded())))}}),[l,o]);return i?{adapter:l,cameraFrame:c,setCameraFrame:d,onMapLoad:u,mapProps:{onLoad:u,preventStyleDiffing:!0},deckProps:l.getProps({deck:r,extraProps:{layers:h}})}:{adapter:l,cameraFrame:c,setCameraFrame:d,mapProps:{},deckProps:l.getProps({deck:r,onNextFrame:o,extraProps:{layers:h}})}}}}]);